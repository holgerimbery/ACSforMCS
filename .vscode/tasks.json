{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "build",
      "command": "dotnet",
      "type": "process",
      "args": [
        "build",
        "${workspaceFolder}/ACSforMCS.csproj",
        "/property:GenerateFullPaths=true",
        "/consoleloggerparameters:NoSummary"
      ],
      "problemMatcher": "$msCompile"
    },
    {
      "label": "Create Azure Resources",
      "type": "shell",
      "command": "pwsh",
      "args": [
        "-File",
        "${workspaceFolder}/scripts/create-azure-resources.ps1",
        "-ApplicationName",
        "${input:applicationName}",
        "-Location",
        "${input:azureLocation}",
        "-Environment",
        "${input:environment}"
      ],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": true,
        "clear": false
      },
      "problemMatcher": []
    },
    {
      "label": "Validate Azure Resource Names",
      "type": "shell",
      "command": "pwsh",
      "args": [
        "-File",
        "${workspaceFolder}/scripts/create-azure-resources.ps1",
        "-ApplicationName",
        "${input:applicationName}",
        "-Location",
        "${input:azureLocation}",
        "-Environment",
        "${input:environment}",
        "-ValidateOnly"
      ],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": true,
        "clear": false
      },
      "problemMatcher": []
    },
    {
      "label": "Set Development BaseUri",
      "type": "shell",
      "command": "az",
      "args": [
        "keyvault", "secret", "set",
        "--vault-name", "${input:keyVaultName}",
        "--name", "BaseUri-Development",
        "--value", "${input:devBaseUri}"
      ],
      "problemMatcher": []
    },
    {
      "label": "Set Production BaseUri",
      "type": "shell",
      "command": "az",
      "args": [
        "keyvault", "secret", "set",
        "--vault-name", "${input:keyVaultName}",
        "--name", "BaseUri-Production",
        "--value", "${input:prodBaseUri}"
      ],
      "problemMatcher": []
    },
    {
      "label": "Set ACS Connection String",
      "type": "shell",
      "command": "az",
      "args": [
        "keyvault", "secret", "set",
        "--vault-name", "${input:keyVaultName}",
        "--name", "AcsConnectionString",
        "--value", "${input:acsConnectionString}"
      ],
      "problemMatcher": []
    },
    {
      "label": "Set Agent Phone Number",
      "type": "shell",
      "command": "az",
      "args": [
        "keyvault", "secret", "set",
        "--vault-name", "${input:keyVaultName}",
        "--name", "AgentPhoneNumber",
        "--value", "${input:agentPhoneNumber}"
      ],
      "problemMatcher": []
    },
    {
      "label": "Set Cognitive Service Endpoint",
      "type": "shell",
      "command": "az",
      "args": [
        "keyvault", "secret", "set",
        "--vault-name", "${input:keyVaultName}",
        "--name", "CognitiveServiceEndpoint",
        "--value", "${input:cognitiveServiceEndpoint}"
      ],
      "problemMatcher": []
    },
    {
      "label": "Set DirectLine Secret",
      "type": "shell",
      "command": "az",
      "args": [
        "keyvault", "secret", "set",
        "--vault-name", "${input:keyVaultName}",
        "--name", "DirectLineSecret",
        "--value", "${input:directLineSecret}"
      ],
      "problemMatcher": []
    },
    {
      "label": "Set Health Check API Key",
      "type": "shell",
      "command": "az",
      "args": [
        "keyvault", "secret", "set",
        "--vault-name", "${input:keyVaultName}",
        "--name", "HealthCheckApiKey",
        "--value", "${input:healthCheckApiKey}"
      ],
      "problemMatcher": []
    },
    {
      "label": "View Development BaseUri",
      "type": "shell",
      "command": "az",
      "args": [
        "keyvault", "secret", "show",
        "--vault-name", "${input:keyVaultName}",
        "--name", "BaseUri-Development",
        "--query", "value",
        "--output", "tsv"
      ],
      "options": {
        "shell": {
          "executable": "cmd.exe",
          "args": ["/c"]
        }
      },
      "problemMatcher": []
    },
    {
      "label": "View Production BaseUri",
      "type": "shell",
      "command": "az",
      "args": [
        "keyvault", "secret", "show",
        "--vault-name", "${input:keyVaultName}",
        "--name", "BaseUri-Production",
        "--query", "value",
        "--output", "tsv"
      ],
      "options": {
        "shell": {
          "executable": "cmd.exe",
          "args": ["/c"]
        }
      },
      "problemMatcher": []
    },
    {
      "label": "List All Key Vault Secrets",
      "type": "shell",
      "command": "az",
      "args": [
        "keyvault", "secret", "list",
        "--vault-name", "${input:keyVaultName}",
        "--query", "[].{name:name,enabled:attributes.enabled}",
        "--output", "table"
      ],
      "options": {
        "shell": {
          "executable": "cmd.exe",
          "args": ["/c"]
        }
      },
      "problemMatcher": []
    },
    {
      "label": "View Health Check API Key",
      "type": "shell",
      "command": "az",
      "args": [
        "keyvault", "secret", "show",
        "--vault-name", "${input:keyVaultName}",
        "--name", "HealthCheckApiKey",
        "--query", "value",
        "--output", "tsv"
      ],
      "options": {
        "shell": {
          "executable": "cmd.exe",
          "args": ["/c"]
        }
      },
      "problemMatcher": []
    },
    {
      "label": "View Any Key Vault Secret",
      "type": "shell",
      "command": "az",
      "args": [
        "keyvault", "secret", "show",
        "--vault-name", "${input:keyVaultName}",
        "--name", "${input:secretName}",
        "--query", "value",
        "--output", "tsv"
      ],
      "options": {
        "shell": {
          "executable": "cmd.exe",
          "args": ["/c"]
        }
      },
      "problemMatcher": []
    },
    {
      "label": "View Secret with Details",
      "type": "shell",
      "command": "az",
      "args": [
        "keyvault", "secret", "show",
        "--vault-name", "${input:keyVaultName}",
        "--name", "${input:secretName}",
        "--output", "json"
      ],
      "options": {
        "shell": {
          "executable": "cmd.exe",
          "args": ["/c"]
        }
      },
      "problemMatcher": []
    }
  ],
  "inputs": [
    {
      "id": "applicationName",
      "description": "Application Name (3-15 characters, lowercase alphanumeric only)",
      "default": "myproject",
      "type": "promptString"
    },
    {
      "id": "azureLocation",
      "description": "Azure Region",
      "default": "West Europe",
      "type": "pickString",
      "options": [
        "West Europe",
        "East US",
        "East US 2",
        "West US 2",
        "Central US",
        "North Europe",
        "South Central US",
        "West Central US",
        "UK South",
        "Australia East",
        "Southeast Asia"
      ]
    },
    {
      "id": "environment",
      "description": "Environment Type",
      "default": "prod",
      "type": "pickString",
      "options": [
        "dev",
        "test", 
        "prod"
      ]
    },
    {
      "id": "keyVaultName",
      "description": "Azure Key Vault Name (e.g., kv-resource-base-name)",
      "default": "kv-resource-base-name",
      "type": "promptString"
    },
    {
      "id": "devBaseUri",
      "description": "Development BaseUri (e.g., https://your-devtunnel-url)",
      "default": "https://your-devtunnel-url",
      "type": "promptString"
    },
    {
      "id": "prodBaseUri",
      "description": "Production BaseUri (e.g., https://app-your-resource-base-name.azurewebsites.net)",
      "default": "https://app-your-resource-base-name.azurewebsites.net",
      "type": "promptString"
    },
    {
      "id": "acsConnectionString",
      "description": "ACS Connection String",
      "default": "endpoint=https://your-acs-resource.communication.azure.com/;accesskey=your-access-key",
      "type": "promptString"
    },
    {
      "id": "agentPhoneNumber",
      "description": "Agent Phone Number (e.g., +1234567890)",
      "default": "+1234567890",
      "type": "promptString"
    },
    {
      "id": "cognitiveServiceEndpoint",
      "description": "Cognitive Service Endpoint URL",
      "default": "https://your-cognitive-service.cognitiveservices.azure.com/",
      "type": "promptString"
    },
    {
      "id": "directLineSecret",
      "description": "DirectLine Secret Key",
      "default": "your-directline-secret",
      "type": "promptString"
    },
    {
      "id": "healthCheckApiKey",
      "description": "Health Check API Key (32-character alphanumeric string)",
      "default": "your-32-character-api-key-here",
      "type": "promptString"
    },
    {
      "id": "secretName",
      "description": "Key Vault Secret Name to view",
      "default": "AcsConnectionString",
      "type": "promptString"
    }
  ]
}